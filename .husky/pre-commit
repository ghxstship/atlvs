#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üé® Validating design tokens..."

# Run token validation and capture output
cd packages/ui && pnpm validate:tokens 2>&1 | tee /tmp/token-validation.txt

# Check for errors (not warnings)
ERROR_COUNT=$(grep -c "‚ùå" /tmp/token-validation.txt || true)

if [ "$ERROR_COUNT" -gt 0 ]; then
  echo ""
  echo "‚ùå Design token validation failed with $ERROR_COUNT critical errors!"
  echo ""
  echo "Hardcoded color values detected. Please fix before committing."
  echo ""
  echo "Quick fix:"
  echo "  pnpm fix:colors"
  echo "  pnpm validate:tokens"
  echo ""
  exit 1
fi

WARNING_COUNT=$(grep -c "‚ö†Ô∏è" /tmp/token-validation.txt || true)
if [ "$WARNING_COUNT" -gt 0 ]; then
  echo ""
  echo "‚ö†Ô∏è  $WARNING_COUNT design token warnings found (non-blocking)"
  echo "   These should be fixed in future commits."
  echo ""
fi

echo "‚úÖ Design tokens validated successfully! (0 errors)"
