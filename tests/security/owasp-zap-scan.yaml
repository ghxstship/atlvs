# OWASP ZAP Automation Framework configuration
env:
  contexts:
    - name: ghxstship
      urls:
        - http://localhost:3000
      includePaths:
        - "http://localhost:3000/.*"
      excludePaths:
        - "http://localhost:3000/logout.*"
        - "http://localhost:3000/api/auth/.*"
      authentication:
        method: "form"
        parameters:
          loginUrl: "http://localhost:3000/login"
          loginRequestData: "email={%username%}&password={%password%}"
        verification:
          method: "response"
          loggedInRegex: "\\Qdashboard\\E"
          loggedOutRegex: "\\Qlogin\\E"

  parameters:
    failOnError: true
    failOnWarning: false
    progressToStdout: true

jobs:
  - type: passiveScan-config
    parameters:
      maxAlertsPerRule: 10
      scanOnlyInScope: true

  - type: spider
    parameters:
      context: ghxstship
      maxDuration: 10
      maxDepth: 5
      maxChildren: 10

  - type: spiderAjax
    parameters:
      context: ghxstship
      maxDuration: 10
      maxCrawlDepth: 5

  - type: passiveScan-wait
    parameters:
      maxDuration: 10

  - type: activeScan
    parameters:
      context: ghxstship
      policy: Default Policy
      maxRuleDurationInMins: 5
      maxScanDurationInMins: 30

  - type: report
    parameters:
      template: traditional-html
      reportDir: test-results/security
      reportFile: zap-report.html
      reportTitle: GHXSTSHIP Security Scan Report
      reportDescription: OWASP ZAP security scan results

  - type: report
    parameters:
      template: traditional-json
      reportDir: test-results/security
      reportFile: zap-report.json

# Alert filters
alertFilters:
  - ruleId: 10021 # X-Content-Type-Options Header Missing
    newRisk: Info
  - ruleId: 10020 # X-Frame-Options Header Not Set
    newRisk: Low
  - ruleId: 10096 # Timestamp Disclosure
    newRisk: Info
